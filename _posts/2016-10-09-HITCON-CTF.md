---
layout: news
title: 2016-10-09-HITCON-CTF
---

https://ctf2016.hitcon.org  

### Are you rich? - Web - 50
--------------------------------------------------------------------------------------------
http://52.197.140.254/are_you_rich/

- Link leads to a webpage named "Bitcoinshop".
- A second page generates bitcoin addresses for you to "send" bitcoin in order to buy flags.
- A third page verifies the payment based on the submitted address and selected flag type.
- 1st thought was to get an address on the blockchain with more than 5btc and try to verify it.
- This attempt fails returning a message "This address was not generated by us".
- At this point we realize addresses are being stored somewhere, probably on a database.
- Trying basic SQLi attack vectors we realize there is a length validation on the address input.
- Input must be, at least, 26 chars long (minimum size for a bitcoin address).
- We try to satisfy this requirement by adding '#' characters at the end of our query.
- Submitting ths input "' or 1=1##################", we obtain an error "too many rows".
- At this point we have confirmation that sqli is possible, db is probably mysql, and tried a couple of query variations.
- Using the 'order by' clause, we discover that only on column is being selected from the database.
- Using 'limit' and 'offset' we try to grab a valid record, but they all return with zero balance or invalid address.
- Trying an 'union' clause with input "' union select 5##########" we get 'external api rejects this address'.
- So it seems that after checking for the address on the db, it checks it's balance against an api.
- We try again with a valid existing address with more than 5btc as "' union select '12oGNa1wSXCGGRin1hq1UW6K4gcs1AvWyZ".
- This way "our" address is sent by the db into the external api, balance check passes and we get our flag.
- hitcon{4r3_y0u_r1ch?ju57_buy_7h3_fl4g!!}


### Are you rich 2? - Web - 100
--------------------------------------------------------------------------------------------
http://52.197.140.254/are_you_rich/

- For the second flag, we just need an address with at least 100k btc in it.
- We can find one at http://www.bitcoinrichlist.com/top100.
- Submitting "' union select '3Nxwenay9Z8Lc9JBiywExpnEFiLp6Afp8v" we get the flag.
- hitcon{u51n6_07h3r_6uy5_b17c0n_70_byp455_ch3ck1n6_15_fun!!}
